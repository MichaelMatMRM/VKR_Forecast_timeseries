# VKR_Forecast_timeseries
Применение алгоритмов машинного обучения для построения прогноза по временным рядам

Качественный прогноз позволяет изменять стратегию ведения бизнеса, оптимизировать расходы для создания продукции, осуществлять их контроль.

Целью работы является построение прогноза экономического временного ряда и оценка значимости прогноза на реальных данных.

Задачи, реашемые в рамках работы:

•	Выбор модели прогнозирования;

•	Разработка алгоритма автоматического подбора параметров модели на основе алгоритмов машинного обучения на данных сети мастерских города Санкт-Петербурга (продажи рамок для картин);

•	Создание программы для апробации решения задачи учета продаж, правила прогнозирования и визуализации прогноза;

Временной ряд – последовательность наблюдений некоторого признака случайной величины в последовательные моменты времени. 
Для успешного решения задач прогнозирования временной ряд должен удовлетворять требованиям слабой стационарности.
Временной ряд называется стационарным (в широком смысле) если выполняется:
	Постоянство математического ожидания во времени 
M(y_1 )=M(y_2 )=M(y_3 )=⋯
	Постоянство дисперсии во времени 
D(y_1 )=D(y_2 )=D(y_3 )=⋯
	Постоянство коэффициента корреляции во времени 
Cov(y_1, y_2) = Cov(y_2,y_3) = Cov(y_3,y_4) = …


Исследуемые временные ряды представляют из себя данные по продажам рамок для картин из разного материала, размером в 100 наблюдений, с января 2014 года по апрель 2022 года. 
Анализ разложения компонентов исследуемых временных рядов показал, что во всех трех исследуемых временных рядах есть четко выраженный тренд и сезонность, что говорит о том, что ни а каком постоянстве математического ожидания и дисперсии  речи быть не может. Ряды не стационарны.


Выбор модели происходит исходя из предметной области и поставленной задачи прогнозирования.
	Необходимый прогноз находиться в диапазоне от 1 до 12 месяцев. Наилучшим решением будет использование авторегрессионных моделей, так как они показывают хороший результат прогноза на короткие дистанции.
	Среди авторегрессионных моделей для исследуемых временных рядов наилучшим решением будет использование модели SARIMA, так как она содержит в себе механизмы позволяющие сделать ряд стационарным.
Она совмещает в себе слагаемые модели AR, которая описывает ВР в виде линейной комбинации этого же ряда и случайной ошибки и модели MA, которая описывает ВР в виде линейной функции зависимости исследуемой величины от разности фактического наблюдения и наблюдений, рассчитанных в прошлом. Параметры p и q – число слагаемых моделей AR и MA соответственно.
Параметр d – число взятия разностей между соседними значениями. При достаточном количестве операций у ВР пропадает тренд.
Сезонные параметры P D Q находятся аналогичным образом, только с отставанием в размер сезона. Благодаря сезонной модификации ликвидируется сезонная составляющая временного ряда.
Параметр m – тип сезонности, известен изначально при анализе ВР. Он равен 12 так как, сезон равен 1 году.


Для нахождения параметров модели SARIMA мы будем использовать алгоритм пошагового поиска параметров с оптимизацией информационного критерия Акаике.
	Критерий Акаике основан на компромиссе между точностью и сложностью модели.
	Точность модели – это то насколько близко модель описывает поведение исследуемого признака. Показатель точности – RSS (сумма квадратов ошибок)
	Сложность модели – это число сезонных и несезонных коэффицентов модели - k
	Найти значение AIC значит рассчитать штраф, накладываемый на RSS и k. Лучшей будет та модель, у которой значение AIC будет меньше.
	В результате поиска среди возможных комбинаций мы получим наилучшую модель по критерию AIC.
  
  
  
  Если мы используем алгоритм пошагового поиска параметров на всех данных для тренировки, то возникает проблема переобучения модели.
 Это явление, при котором модель показывает хорошие результаты на данных для тренировки, но плохо описывает поведение наблюдений, не участвующих в обучении.
Эту проблему можно решить при помощи перекрестной проверки (скользящий контроль). 
![image](https://user-images.githubusercontent.com/72271693/178754533-85e00a86-392e-4829-8eb1-fa7741a10df6.png)


